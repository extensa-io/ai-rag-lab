# ðŸ¦¹ Combine pre-filtering with vector search

Pre-filtering a technique to optimize vector search by only considering documents that match certain criteria during vector search.

## Filter for documents where the content type is `Video`

To do this, you will first need to modify the vector search index you created previously. The new index definition should look as follows:

<details>
<summary>Answer</summary>
<div>
```python
{
  "fields": [
    {
      "type": "vector",
      "path": "embedding",
      "numDimensions": 384,
      "similarity": "cosine"
    },
    {
      "type":"filter",
      "path":"metadata.contentType"
    }
  ]
}
```
</div>
</details>

Once you have updated the vector search index, fill in `<CODE_BLOCK_11>` and run the cells under the **Filter for documents where the content type is Video** section in the notebook to see how the filter impacts the vector search results.

The answer for this code block is as follows:

**CODE_BLOCK_11**

<details>
<summary>Answer</summary>
<div>
```python
[
    {
        "$vectorSearch": {
            "index": "vector_index",
            "path": "embedding",
            "queryVector": query_embedding,
            "numCandidates": 150,
            "limit": 5,
            "filter": {"metadata.contentType": "Video"}
        }
    },
    {
        "$project": {
            "_id": 0,
            "body": 1,
            "score": {"$meta": "vectorSearchScore"}
        }
    }
]
```
</div>
</details>


## Filter on documents which have been updated on or after `2024-05-19` and where the content type is `Tutorial`

Again, you will need to modify the vector search index. The new index definition should look as follows:

<details>
<summary>Answer</summary>
<div>
```python
{
  "fields": [
    {
      "type": "vector",
      "path": "embedding",
      "numDimensions": 384,
      "similarity": "cosine"
    },
    {
      "type":"filter",
      "path":"metadata.contentType"
    },
    {
      "type":"filter",
      "path":"updated"
    }
  ]
}
```
</div>
</details>

Once you have updated the vector search index, fill in `<CODE_BLOCK_12>` and run the cells under the **Filter on documents which have been updated on or after 2024-05-19 and where the content type is Tutorial** section in the notebook to see how the filter impacts the vector search results.

The answer for this code block is as follows:

**CODE_BLOCK_12**

<details>
<summary>Answer</summary>
<div>
```python
[
    {
        "$vectorSearch": {
            "index": "vector_index",
            "path": "embedding",
            "queryVector": query_embedding,
            "numCandidates": 150,
            "limit": 5,
            "filter": {
                "metadata.contentType": "Tutorial",
                "updated": {"$gte": "2024-05-19"}
            }
        }
    },
    {
        "$project": {
            "_id": 0,
            "body": 1,
            "score": {"$meta": "vectorSearchScore"}
        }
    }
]
```
</div>
</details>